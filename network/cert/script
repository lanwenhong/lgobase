# 1. 生成根证书私钥（RSA 2048位）
openssl genrsa -out rootCA.key 2048

# 2. 生成根证书（有效期10年）
openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 3650 -out rootCA.pem \
  -subj "/C=CN/ST=Beijing/L=Beijing/O=MyOrg/OU=MyDept/CN=MyRootCA"

# 3. 生成服务器私钥
openssl genrsa -out server.key 2048

# 4. 生成服务器证书请求（CSR）
openssl req -new -key server.key -out server.csr \
  -subj "/C=CN/ST=Beijing/L=Beijing/O=MyOrg/OU=Server/CN=localhost"

# 5. 使用根证书签署服务器证书（有效期1年）
openssl x509 -req -in server.csr -CA rootCA.pem -CAkey rootCA.key \
  -CAcreateserial -out server.pem -days 365 -sha256


# 6. 生成客户端私钥
openssl genrsa -out client.key 2048

# 7. 生成客户端证书请求（CSR）
# 注意：CN 可自定义，但服务器验证时会检查证书有效性（非强制匹配域名）
openssl req -new -key client.key -out client.csr \
  -subj "/C=CN/ST=Beijing/L=Beijing/O=MyOrg/OU=Client/CN=MyClient"

# 8. 使用根证书签署客户端证书（有效期1年）
openssl x509 -req -in client.csr -CA rootCA.pem -CAkey rootCA.key \
  -CAcreateserial -out client.pem -days 365 -sha256
